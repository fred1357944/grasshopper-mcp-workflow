flowchart LR
    subgraph Inputs["輸入參數"]
        SizeX["SizeX Slider<br/>10"]
        SizeY["SizeY Slider<br/>10"]
        SizeZ["SizeZ Slider<br/>10"]
        Count["Count Slider<br/>15"]
        Seed["Seed Slider<br/>42"]
        PartName["PartName Panel<br/>Cube"]
    end

    subgraph Geometry["幾何生成"]
        MeshBox["Mesh Box<br/>X,Y,Z → M"]
    end

    subgraph WASP_Prep["WASP 準備"]
        FaceN["Face Normals<br/>M → C,N"]
        ConnDir["Wasp_Connection From Direction<br/>GEO,CEN → CONN"]
    end

    subgraph WASP_Core["WASP 核心"]
        BasicPart["Wasp_Basic Part<br/>NAME,GEO,CONN → PART"]
        Rule["Wasp_Rule<br/>PART → RULES"]
        StochAggr["Wasp_Stochastic Aggregation<br/>PART,RULES,N,SEED → AGGR"]
    end

    %% 連接關係
    SizeX --> MeshBox
    SizeY --> MeshBox
    SizeZ --> MeshBox

    MeshBox --> FaceN
    MeshBox --> ConnDir
    FaceN -->|C| ConnDir

    PartName --> BasicPart
    MeshBox --> BasicPart
    ConnDir -->|CONN| BasicPart

    BasicPart -->|PART| Rule
    BasicPart -->|PART| StochAggr
    Rule -->|RULES| StochAggr
    Count --> StochAggr
    Seed --> StochAggr

%% ===== 組件 GUID 對照表 (從 MCP 查詢) =====
%%
%% | 組件名稱                      | GUID                                   |
%% |------------------------------|----------------------------------------|
%% | Mesh Box                     | c4ac4e68-060e-4cd0-85b1-1f2e3663c449   |
%% | Face Normals                 | f4370b82-4bd6-4ca7-90e8-c88584b280d5   |
%% | Wasp_Connection From Direction | 9a48eda9-6f67-47b4-915a-689acc550ffb |
%% | Wasp_Basic Part              | 02ffc0b4-fc50-4f0c-85ad-b27949c99e51   |
%% | Wasp_Rule                    | 6d499113-9608-4e4e-b90b-f1b0e681b4e3   |
%% | Wasp_Stochastic Aggregation  | e5dd0f7b-6392-466e-8ce4-f2e393ddae6e   |
%%
%% ===== 參數對照表 =====
%%
%% | 組件                         | 輸入              | 輸出       |
%% |-----------------------------|-------------------|-----------|
%% | Mesh Box                    | X,Y,Z             | M         |
%% | Face Normals                | M                 | C,N       |
%% | Wasp_Connection From Dir    | GEO,CEN,UP,T      | CONN      |
%% | Wasp_Basic Part             | NAME,GEO,CONN     | PART      |
%% | Wasp_Rule                   | PART,PART,T       | RULES     |
%% | Wasp_Stochastic Aggregation | PART,PREV,RULES,COLL,FIELD,N,SEED,RESET | AGGR |
