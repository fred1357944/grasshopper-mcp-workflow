{
  "_meta": {
    "name": "Spiral Staircase v3 - Using Center Box",
    "description": "螺旋樓梯 v3 (用 Center Box 取代 Rectangle，避免 obsolete 問題)",
    "fixes": [
      "1. 用 Center Box 建立踏板 (接受 Number)",
      "2. 確保產生多個踏板 (Graft 處理)",
      "3. 正確的螺旋邏輯"
    ],
    "created_at": "2026-01-27"
  },
  "components": [
    {
      "id": "height_slider",
      "type": "Number Slider",
      "nickname": "Height",
      "col": 0, "row": 0,
      "min": 3000, "max": 8000, "value": 5000,
      "_comment": "總高度 (mm)"
    },
    {
      "id": "radius_slider",
      "type": "Number Slider",
      "nickname": "Radius",
      "col": 0, "row": 1,
      "min": 1000, "max": 2500, "value": 1500,
      "_comment": "螺旋半徑 (mm)"
    },
    {
      "id": "steps_slider",
      "type": "Number Slider",
      "nickname": "Steps",
      "col": 0, "row": 2,
      "min": 15, "max": 40, "value": 25,
      "decimals": 0,
      "_comment": "踏板數量"
    },
    {
      "id": "angle_slider",
      "type": "Number Slider",
      "nickname": "TotalAngle",
      "col": 0, "row": 3,
      "min": 360, "max": 1080, "value": 720,
      "_comment": "總旋轉角度 (度)"
    },
    {
      "id": "step_width_slider",
      "type": "Number Slider",
      "nickname": "StepWidth",
      "col": 0, "row": 4,
      "min": 600, "max": 1200, "value": 800,
      "_comment": "踏板寬度 (mm)"
    },
    {
      "id": "step_depth_slider",
      "type": "Number Slider",
      "nickname": "StepDepth",
      "col": 0, "row": 5,
      "min": 200, "max": 400, "value": 300,
      "_comment": "踏板深度 (mm)"
    },
    {
      "id": "step_thick_slider",
      "type": "Number Slider",
      "nickname": "StepThick",
      "col": 0, "row": 6,
      "min": 30, "max": 80, "value": 50,
      "_comment": "踏板厚度 (mm)"
    },
    {
      "id": "rail_height_slider",
      "type": "Number Slider",
      "nickname": "RailHeight",
      "col": 0, "row": 7,
      "min": 850, "max": 1100, "value": 900,
      "_comment": "扶手高度 (mm)"
    },
    {
      "id": "rail_diameter_slider",
      "type": "Number Slider",
      "nickname": "RailDia",
      "col": 0, "row": 8,
      "min": 30, "max": 50, "value": 40,
      "_comment": "扶手直徑 (mm)"
    },

    {
      "id": "range",
      "type": "Range",
      "nickname": "T_Param",
      "col": 2, "row": 1,
      "_comment": "生成 0.0 到 1.0 的參數值 (26 個值 for 25 steps)"
    },

    {
      "id": "height_mult",
      "type": "Multiplication",
      "nickname": "Z_Height",
      "col": 3, "row": 0,
      "_comment": "t * Height"
    },
    {
      "id": "angle_mult",
      "type": "Multiplication",
      "nickname": "AngleDeg",
      "col": 3, "row": 2,
      "_comment": "t * TotalAngle"
    },

    {
      "id": "radians",
      "type": "Radians",
      "nickname": "AngleRad",
      "col": 4, "row": 2,
      "_comment": "度 → 弧度"
    },

    {
      "id": "sin",
      "type": "Sine",
      "nickname": "SinA",
      "col": 5, "row": 1
    },
    {
      "id": "cos",
      "type": "Cosine",
      "nickname": "CosA",
      "col": 5, "row": 3
    },
    {
      "id": "x_mult",
      "type": "Multiplication",
      "nickname": "X_Coord",
      "col": 6, "row": 1,
      "_comment": "Radius * Cos"
    },
    {
      "id": "y_mult",
      "type": "Multiplication",
      "nickname": "Y_Coord",
      "col": 6, "row": 3,
      "_comment": "Radius * Sin"
    },

    {
      "id": "step_center",
      "type": "Construct Point",
      "nickname": "StepPt",
      "col": 7, "row": 2,
      "_comment": "踏板中心點 (X, Y, Z)"
    },

    {
      "id": "step_plane",
      "type": "XY Plane",
      "nickname": "StepPlane",
      "col": 8, "row": 2,
      "guid": "b581a89a-cd22-41be-9d3b-7f0ee059eaee",
      "_comment": "在踏板位置建立 XY 平面"
    },

    {
      "id": "rotate_plane",
      "type": "Rotate Plane",
      "nickname": "RotPlane",
      "col": 9, "row": 2,
      "guid": "dd5b6d62-986b-419c-b8a7-729c4f23ba79",
      "_comment": "旋轉平面使踏板朝向正確方向"
    },

    {
      "id": "step_box",
      "type": "Center Box",
      "nickname": "StepBox",
      "col": 10, "row": 2,
      "guid": "2fa3fcfd-7780-48fb-a1d1-860a49bc5f76",
      "_comment": "用 Center Box 建立踏板 (接受 Number, 不是 Domain)"
    },

    {
      "id": "rail_z",
      "type": "Addition",
      "nickname": "RailZ",
      "col": 7, "row": 5,
      "_comment": "StepZ + RailHeight"
    },
    {
      "id": "rail_point",
      "type": "Construct Point",
      "nickname": "RailPt",
      "col": 8, "row": 5,
      "_comment": "扶手點"
    },
    {
      "id": "interpolate",
      "type": "Interpolate",
      "nickname": "RailCurve",
      "col": 9, "row": 5,
      "_comment": "扶手曲線"
    },
    {
      "id": "pipe",
      "type": "Pipe",
      "nickname": "RailPipe",
      "col": 10, "row": 5,
      "guid": "607ee621-e54c-4690-8987-cc689a23f92f",
      "_comment": "扶手管道"
    }
  ],
  "connections": [
    {"from": "steps_slider", "fromParam": "N", "to": "range", "toParam": "N", "toParamIndex": 1, "_comment": "Steps 數量"},

    {"from": "range", "fromParam": "R", "to": "height_mult", "toParam": "A", "toParamIndex": 0},
    {"from": "height_slider", "fromParam": "N", "to": "height_mult", "toParam": "B", "toParamIndex": 1},

    {"from": "range", "fromParam": "R", "to": "angle_mult", "toParam": "A", "toParamIndex": 0},
    {"from": "angle_slider", "fromParam": "N", "to": "angle_mult", "toParam": "B", "toParamIndex": 1},

    {"from": "angle_mult", "fromParam": "R", "to": "radians", "toParam": "D", "toParamIndex": 0},

    {"from": "radians", "fromParam": "R", "to": "sin", "toParam": "x", "toParamIndex": 0},
    {"from": "radians", "fromParam": "R", "to": "cos", "toParam": "x", "toParamIndex": 0},

    {"from": "cos", "fromParam": "y", "to": "x_mult", "toParam": "A", "toParamIndex": 0},
    {"from": "radius_slider", "fromParam": "N", "to": "x_mult", "toParam": "B", "toParamIndex": 1},

    {"from": "sin", "fromParam": "y", "to": "y_mult", "toParam": "A", "toParamIndex": 0},
    {"from": "radius_slider", "fromParam": "N", "to": "y_mult", "toParam": "B", "toParamIndex": 1},

    {"from": "x_mult", "fromParam": "R", "to": "step_center", "toParam": "X", "toParamIndex": 0},
    {"from": "y_mult", "fromParam": "R", "to": "step_center", "toParam": "Y", "toParamIndex": 1},
    {"from": "height_mult", "fromParam": "R", "to": "step_center", "toParam": "Z", "toParamIndex": 2},

    {"from": "step_center", "fromParam": "Pt", "to": "step_plane", "toParam": "O", "toParamIndex": 0},

    {"from": "step_plane", "fromParam": "P", "to": "rotate_plane", "toParam": "P", "toParamIndex": 0},
    {"from": "radians", "fromParam": "R", "to": "rotate_plane", "toParam": "A", "toParamIndex": 1},

    {"from": "rotate_plane", "fromParam": "P", "to": "step_box", "toParam": "B", "toParamIndex": 0, "_comment": "Center Box.Base = Plane"},
    {"from": "step_width_slider", "fromParam": "N", "to": "step_box", "toParam": "X", "toParamIndex": 1},
    {"from": "step_depth_slider", "fromParam": "N", "to": "step_box", "toParam": "Y", "toParamIndex": 2},
    {"from": "step_thick_slider", "fromParam": "N", "to": "step_box", "toParam": "Z", "toParamIndex": 3},

    {"from": "height_mult", "fromParam": "R", "to": "rail_z", "toParam": "A", "toParamIndex": 0},
    {"from": "rail_height_slider", "fromParam": "N", "to": "rail_z", "toParam": "B", "toParamIndex": 1},

    {"from": "x_mult", "fromParam": "R", "to": "rail_point", "toParam": "X", "toParamIndex": 0},
    {"from": "y_mult", "fromParam": "R", "to": "rail_point", "toParam": "Y", "toParamIndex": 1},
    {"from": "rail_z", "fromParam": "R", "to": "rail_point", "toParam": "Z", "toParamIndex": 2},

    {"from": "rail_point", "fromParam": "Pt", "to": "interpolate", "toParam": "V", "toParamIndex": 0},

    {"from": "interpolate", "fromParam": "C", "to": "pipe", "toParam": "C", "toParamIndex": 0},
    {"from": "rail_diameter_slider", "fromParam": "N", "to": "pipe", "toParam": "R", "toParamIndex": 1}
  ],
  "layout": {
    "strategy": "smart",
    "spacing": {"x": 120, "y": 60}
  }
}
